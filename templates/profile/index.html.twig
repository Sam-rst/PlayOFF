{% extends 'base.html.twig' %}

{% block body %}

	<!-- Contenu de la page -->
	<div class="container">
		<div class="profile-header">
			<h1>Profil Utilisateur</h1>
			<h3>
				{% if user %}
					{{ user.getUsername() }}
				{% else %}
					Nom Utilisateur
				{% endif %}
			</h3>
		</div>

		<div class="profile-info">
			<p>
				<strong>Nom:</strong>
				{% if user %}
					{{ user.LastName() }}
				{% else %}
					Nom inconnu
				{% endif %}
			</p>
			<p>
				<strong>Prénom:</strong>
				{% if user %}
					{{ user.FirstName() }}
				{% else %}
					Prénom inconnu
				{% endif %}
			</p>
			<p>
				<strong>Email:</strong>
				{% if user %}
					{{ user.email }}
				{% else %}
					Email inconnu
				{% endif %}
			</p>
		</div>

		<!-- Onglets pour les statistiques et l'historique des tournois -->
		<ul class="nav nav-tabs" id="myTab" role="tablist">
			<li class="nav-item">
				<a class="nav-link active" id="stats-tab" data-toggle="tab" href="#stats" role="tab" aria-controls="stats" aria-selected="true">Statistiques</a>
			</li>
			<li class="nav-item">
				<a class="nav-link" id="history-tab" data-toggle="tab" href="#history" role="tab" aria-controls="history" aria-selected="false">Historique des Tournois</a>
			</li>
		</ul>

		<!-- Contenu des onglets -->
		<div
			class="tab-content" id="myTabContent">
			<!-- Onglet Statistiques -->
			<div class="tab-pane fade show active" id="stats" role="tabpanel" aria-labelledby="stats-tab">
				<h3>Statistiques</h3>
				<p>Nombre de victoires:
					{# {% if user %}{{ user.getVictoriesCount() }}{% else %}N/A{% endif %}#}
				</p>
				<p>Ratio de victoires:{# } {% if user %}{{ user.getVictoryRatio() }}{% else %}N/A{% endif %}#}</p>
			</div>

			<!-- Onglet Historique des Tournois -->
			<div class="tab-pane fade" id="history" role="tabpanel" aria-labelledby="history-tab">
				<h3>Historique des Tournois</h3>

				{% set tournamentsParticipated = user.getTournamentsParticipated() %}

				{% if tournamentsParticipated is not empty %}
					{% for tournament in tournamentsParticipated %}
						<div class="tournament-card">
							<div class="tournament-card-header">
								<h5>{{ tournament.getName() }}</h5>
								{% set currentTime = "now"|date('Y-m-d H:i:s') %}
								{% set startTime = tournament.getStartTime()|date('Y-m-d H:i:s') %}
								{% set endTime = tournament.getEndTime()|date('Y-m-d H:i:s') %}

								{% if currentTime >= startTime and currentTime <= endTime %}
									<p>Statut : En cours</p>
								{% elseif currentTime > endTime %}
									<p>Statut : Terminé</p>
								{% else %}
									<p>Statut : À venir</p>
								{% endif %}
							</div>
						</div>
					{% endfor %}
				{% else %}
					<div class="alert alert-info" role="alert">
						Aucun tournoi trouvé dans l'historique.
					</div>
				{% endif %}
			</div>
		</div>
	</div>

{% endblock %}

{% block stylesBrut %}
	<style>
		body {
			font-family: Arial, sans-serif;
			background-color: #f8f9fa;
			color: #333;
		}

		.container {
			max-width: 800px;
			margin: 0 auto;
		}

		.profile-header {
			text-align: center;
			margin-bottom: 30px;
		}

		.profile-info {
			background-color: #fff;
			padding: 20px;
			border-radius: 8px;
			box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
			margin-bottom: 30px;
		}

		.nav-tabs {
			border-bottom: 2px solid #007bff;
			margin-bottom: 20px;
		}

		.nav-tabs .nav-item {
			margin-bottom: -1px;
		}

		.nav-tabs .nav-link {
			color: #333;
			border: 1px solid transparent;
			border-top-left-radius: 0;
			border-top-right-radius: 0;
		}

		.nav-tabs .nav-link.active {
			background-color: #fff;
			border-color: #007bff #007bff #fff;
		}

		.tab-content {
			background-color: #fff;
			padding: 20px;
			border-radius: 8px;
			box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
		}

		/* Styling for tournament cards */
		.tournament-card {
			border: 1px solid #ccc;
			border-radius: 5px;
			margin-bottom: 10px;
			padding: 10px;
			background-color: #f8f9fa;
		}

		.tournament-card-header {
			font-weight: bold;
			margin-bottom: 5px;
		}

		.tournament-card-body {
			color: #333;
		}

		/* Styling for alert message */
		.alert {
			padding: 10px;
			border-radius: 5px;
			background-color: #d1ecf1;
			color: #0c5460;
			border: 1px solid #bee5eb;
			margin-bottom: 10px;
		}
		.tournament-card {
			border: 1px solid #ccc;
			border-radius: 5px;
			margin-bottom: 10px;
			padding: 10px;
			background-color: #f8f9fa;
		}

		.tournament-card-header {
			font-weight: bold;
			margin-bottom: 5px;
		}
	</style>
{% endblock %}
